---
title: '关于状态方程的一些学习记录和思考'
date: 2025-08-06
permalink: /posts/2025-08-06-EOS
tags:
  - 热力学
  - Thermodynamics
---

## 这么老的东西，有啥意思吗？
团队这几年在流程模拟软件开发做了一些工作，主要是复现Aspen的功能，aka 攻克“卡脖子”问题。开发过程中，深刻意识到一个“简单”的闪蒸问题可能卡住几个月。Aspen在上个世纪就已经开发出来，但是商业软件关于技术细节基本没有公开，专利也甚少，且学术界的研究相对较少。国内也是如此，原因大概是不好发论文，以及这类研究对于学生能力要求也很高。
PS: 团队研究生开发了一个状态方程求解密度的底层算法，性能优异，还是很牛的。

## 背景知识

状态方程是描述**压力 P**、**体积 V（或密度 ρ）**与**温度 T**之间热力学关系的函数，用于建立物质的热力学模型。常见形式：

$$P = f(T, V) 或 Z = f(T, P)$$

其中：

- **P**：压力（Pa）
- **T**：温度（K）
- **V**：摩尔体积（m³/mol）
- **Z**：压缩因子（Compressibility factor），定义如下：

$$Z = PV / RT$$

- Z = 1 对应理想气体，Z ≠ 1 说明存在非理性行为。

状态方程的类型太多，目前没有思路如何有条理整理。

## 状态方程中的 Combining Rule 与 Mixing Rule

我也是前阵子才在跟学生讨论中学习到这些信息，以下借助GPT4.0整理。

状态方程在处理多组分混合物时，需要将纯组分的热力学参数（如 $σ, ε, a, b$ 等）组合成混合体系中的有效参数。此过程依赖两个重要概念：

- **Combining Rule（结合规则）**：用于推导不同分子之间的相互作用参数（如 σ_ij, ε_ij）
- **Mixing Rule（混合规则）**：用于将纯组分参数合成为混合物整体的平均参数（如 a_mix, b_mix）

### Combining Rule（结合规则）

#### 作用

用于估算两种不同组分 $i$ 与 $j$ 之间的相互作用参数，例如SAFT方程中的：

- 分子尺寸参数：$σ_{ij}$ 
- 势能深度参数：$ε_{ij}$ 

#### 常见结合规则

| 参数 | Lorentz-Berthelot（最常用） |
|------|-----------------------------|
| $σ_{ij}$  | $σ_{ij}$  = ($σ_{i}  + σ_{j} ) / 2$      |
| $ε_{ij}$ | $ε_{ij}$  = $ √(ε_i * ε_j)$         |

部分模型引入修正项 \( k_{ij} \)：
$$ ε_{ij} = (1 - k_ij) * √(ε_i * ε_j) $$  

### Mixing Rule（混合规则）

#### 作用

用于将组分 $i$ 的纯物性参数（如 $a_i, b_i$）通过摩尔分数 \( x_i \) 加权，构造混合体系的参数 \( a_{mix}, b_{mix} \) 等。

#### 常见混合规则（以 PR/SRK 为例）

| 项目 | 混合规则表达式 |
|------|----------------|
| \( a_{mix} \) | \( a_{mix} = \sum_i \sum_j x_i x_j \sqrt{a_i a_j}(1 - k_{ij}) \) |
| \( b_{mix} \) | \( b_{mix} = \sum_i x_i b_i \) |

其中：
- \( x_i \)：组分摩尔分数
- \( a_i, b_i \)：纯组分参数
- \( k_{ij} \)：二元交互参数（经验拟合）

#### 常见混合规则种类

| 类型 | 说明 |
|------|------|
| Classical van der Waals | 最基础，适用于弱非理性体系 |
| Quadratic Mixing Rule | 常用于 SRK/PR |
| Wong-Sandler Mixing Rule | 引入活度系数模型，与 EOS 耦合 |
| Huron-Vidal Mixing Rule | 结合 NRTL/Margules 活度模型 |
| EoS-GE 方法 | 适用于高度非理性溶液 |
| SAFT-specific Rules | PC-SAFT 等中根据链段数、体积等构建特有规则 |

### 二元交互参数

不难发现，我们通常理解的二元交互参数 $k_{ij}$ 在两种不同规则中均有使用，但是其作用于不同的尺度。对于SAFT方程而言，是分子级修正，PR/SRK则是以相对宏观的修正。PS:类似的参数在状态方程有时候表示为其他符号，但是本质也是一种交互参数。例如，我们对能量参数进行修正，也可以对有效直径进行修正，如下：
$$ ε_{ij} = (1 - k_{ij}) * √(ε_i * ε_j), σ_{ij} = \frac{(σ_i + σ_j)}{2} (1 - l_{ij}) $$  

那么，二元交互参数是否可以预测？首先，这里的预测不是类似于神经网络的预测，用带标签数据训练模型去预测本质上都是外推。其次，如果是通过分子模拟，获得混合物的性质，再跟状态方程进行对比，本身是也是拟合。

如果把预测性定义为：给定两个纯组分的分子结构与纯物性参数，不依赖混合物的任何实验数据和模拟数据，直接计算得到交互参数。似乎是不可行的吧。或者说，现行的任何分子模拟技术，通过模拟两种分子的交互所得到的交互参数，有没有所谓的“拟合”过程。待后续调研吧。
